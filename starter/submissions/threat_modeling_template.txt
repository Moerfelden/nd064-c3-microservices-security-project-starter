Docker Threat Modeling
Given Docker's system components and the STRIDE framework, identify five potential threats that may arise.

1. Unauthorized access to the Docker daemon. This potential threat is associated to Spoofing.
   An attacker could spoof a legitimate user or service to gain unauthorized access to the Docker daemon, allowing them to execute commands, create containers, or manipulate images.

2. Modification of Docker images in the Docker Registry. This potential threat is associated to Tampering.
   An attacker could tamper with Docker images by injecting malicious code or altering configurations. This could lead to the deployment of compromised applications or services.

3. Exposure of sensitive data through logs of Docker's system components. This potential threat is associated to Information Disclosure.
   Sensitive information, such as API keys, passwords, or configuration details, may be inadvertently exposed through log files, making it accessible to unauthorized users or processes.

4. Resource exhaustion attacks on the Docker daemon. This potential threat is associated to Denial of Service (DoS).
   An attacker could launch a denial-of-service attack by consuming excessive resources (CPU, memory, disk space) on the Docker host, leading to service degradation or unavailability.

5. Running containers with elevated privileges. This potential threat is associated to Elevation of Privilege.
   If containers are run with excessive privileges (e.g., using the --privileged flag), an attacker who gains access to a container could compromise the entire Docker environment.



Kubernetes Threat Modeling
Given Kubernetes' system components and the STRIDE framework, identify five potential threats that may arise.

1. Insecure basic authentication is used when calling the API server. This potential threat is associated to Spoofing.
   Recommendation 1.2.2: Ensure that the --basic-auth-file argument is not set.

2. Unauthorized access to the etcd key-value store. This potential threat is associated to Tampering.
   Recommendation 1.1.11: Ensure that the etcd data directory permissions are set to 700 or more restrictive.

3. Exposure of sensitive information through misconfigured access controls. This potential threat is associated to Information Disclosure.
   Recommendation 1.2.7: Ensure that the --authorization-mode argument is not set to AlwaysAllow and Kubernetes role-based access control (RBAC) is properly configured.

4. Too much traffic is directed at kubelet and kubelet can't handle it. This potential threat is associated to Denial of Service (DoS).
   Recommendation 4.2.6: Ensure that the --protect-kernel-defaults argument is set to true.

5. Privileges may be abused by using the privileged flag. This potential threat is associated to Elevation of Privilege.
   Recommendation: This should be avoided in all cases as this could have dire effects on kube-apiserver. 



Docker-bench Run Results and Analysis
From the failed findings, select and document 3 findings from the Docker-bench results that you want to harden based on the 5 attack surface areas you identified in Step 1. 
At least 1 of the 3 hardened findings should be different from the ones mentioned in the exercise (i.e. 5.10, 5.14, and 5.22).
These 3 findings should be related to 3 out of the 5 Docker attack surfaces you identified for Docker in Step 1.

1. [FAIL] 2.2.b Ensure the logging level is set to 'info' (Scored):
   This recommendation relates to the Information Disclosure pillar within the STRIDE framework. 
   It helps mitigate the risk of exposing sensitive information through overly verbose logging. 
   By setting the logging level to 'info', you control the verbosity of the logs generated by Docker and its components.

2. [FAIL] 2.13.b Ensure live restore is enabled (Scored):
   This recommendation relates to the Denial of Service (DoS) pillar within the STRIDE framework.
   By ensuring that live restore is enabled, you reduce the risk of service outages and improve the resilience of your applications against DoS attacks. 
   This is particularly important for production environments where uptime is critical.

3. [FAIL] 4.5 Ensure Content Trust for Docker is enabled (Scored):
   This recommendation relates to the Tampering pillar within the STRIDE framework. 
   By enabling Content Trust, you help prevent unauthorized modifications to Docker images, thereby enhancing the security of your containerized applications. 
   When Content Trust is enabled, Docker will only allow the use of images that have been signed by trusted parties. 
